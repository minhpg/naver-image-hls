const a20_0x371ab5=a20_0x10a1;(function(_0x2a9219,_0xdad69){const _0xbe6acc=a20_0x10a1,_0x586aac=_0x2a9219();while(!![]){try{const _0x2a17e7=parseInt(_0xbe6acc(0x1a6,'tR$P'))/0x1*(parseInt(_0xbe6acc(0x1b6,'fZIZ'))/0x2)+parseInt(_0xbe6acc(0x181,'&H4e'))/0x3*(-parseInt(_0xbe6acc(0x179,'JdKA'))/0x4)+-parseInt(_0xbe6acc(0x186,'mV^a'))/0x5+-parseInt(_0xbe6acc(0x1be,'c088'))/0x6+-parseInt(_0xbe6acc(0x17f,'Y99n'))/0x7+-parseInt(_0xbe6acc(0x17a,'JHOv'))/0x8+parseInt(_0xbe6acc(0x185,'N6#!'))/0x9;if(_0x2a17e7===_0xdad69)break;else _0x586aac['push'](_0x586aac['shift']());}catch(_0x2018d2){_0x586aac['push'](_0x586aac['shift']());}}}(a20_0x2bb9,0x839f9));const a20_0x462c02=function(){let _0x286c36=!![];return function(_0x8f10c1,_0x22c437){const _0x2bf958=_0x286c36?function(){const _0x3aad9d=a20_0x10a1;if(_0x22c437){const _0x48b1af=_0x22c437[_0x3aad9d(0x1ce,'LB3T')](_0x8f10c1,arguments);return _0x22c437=null,_0x48b1af;}}:function(){};return _0x286c36=![],_0x2bf958;};}(),a20_0x5e54a5=a20_0x462c02(this,function(){const _0x1c5420=a20_0x10a1;return a20_0x5e54a5[_0x1c5420(0x1a5,'Djct')]()[_0x1c5420(0x191,'ckgF')](_0x1c5420(0x1d0,'BeDz')+'+$')['toString']()[_0x1c5420(0x1b9,'R#rJ')+'r'](a20_0x5e54a5)[_0x1c5420(0x184,'$Soq')](_0x1c5420(0x199,'Y99n')+'+$');});function a20_0x10a1(_0x3dc0a2,_0x1bd49d){const _0x3173dc=a20_0x2bb9();return a20_0x10a1=function(_0x5e54a5,_0x462c02){_0x5e54a5=_0x5e54a5-0x178;let _0x2bb9f8=_0x3173dc[_0x5e54a5];if(a20_0x10a1['lobOxB']===undefined){var _0x10a174=function(_0x1dbc04){const _0x419092='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x17c0f1='',_0x534f98='',_0xca1269=_0x17c0f1+_0x10a174;for(let _0x4f1809=0x0,_0x2b47ca,_0x4bff4e,_0x597821=0x0;_0x4bff4e=_0x1dbc04['charAt'](_0x597821++);~_0x4bff4e&&(_0x2b47ca=_0x4f1809%0x4?_0x2b47ca*0x40+_0x4bff4e:_0x4bff4e,_0x4f1809++%0x4)?_0x17c0f1+=_0xca1269['charCodeAt'](_0x597821+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x2b47ca>>(-0x2*_0x4f1809&0x6)):_0x4f1809:0x0){_0x4bff4e=_0x419092['indexOf'](_0x4bff4e);}for(let _0x187c96=0x0,_0x59f56c=_0x17c0f1['length'];_0x187c96<_0x59f56c;_0x187c96++){_0x534f98+='%'+('00'+_0x17c0f1['charCodeAt'](_0x187c96)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x534f98);};const _0x10d2b1=function(_0x4f7b72,_0x209eb6){let _0x20810f=[],_0x1c78d5=0x0,_0x3ebcc2,_0x17c62c='';_0x4f7b72=_0x10a174(_0x4f7b72);let _0x1f8b41;for(_0x1f8b41=0x0;_0x1f8b41<0x100;_0x1f8b41++){_0x20810f[_0x1f8b41]=_0x1f8b41;}for(_0x1f8b41=0x0;_0x1f8b41<0x100;_0x1f8b41++){_0x1c78d5=(_0x1c78d5+_0x20810f[_0x1f8b41]+_0x209eb6['charCodeAt'](_0x1f8b41%_0x209eb6['length']))%0x100,_0x3ebcc2=_0x20810f[_0x1f8b41],_0x20810f[_0x1f8b41]=_0x20810f[_0x1c78d5],_0x20810f[_0x1c78d5]=_0x3ebcc2;}_0x1f8b41=0x0,_0x1c78d5=0x0;for(let _0x25788a=0x0;_0x25788a<_0x4f7b72['length'];_0x25788a++){_0x1f8b41=(_0x1f8b41+0x1)%0x100,_0x1c78d5=(_0x1c78d5+_0x20810f[_0x1f8b41])%0x100,_0x3ebcc2=_0x20810f[_0x1f8b41],_0x20810f[_0x1f8b41]=_0x20810f[_0x1c78d5],_0x20810f[_0x1c78d5]=_0x3ebcc2,_0x17c62c+=String['fromCharCode'](_0x4f7b72['charCodeAt'](_0x25788a)^_0x20810f[(_0x20810f[_0x1f8b41]+_0x20810f[_0x1c78d5])%0x100]);}return _0x17c62c;};a20_0x10a1['AdRXtY']=_0x10d2b1,_0x3dc0a2=arguments,a20_0x10a1['lobOxB']=!![];}const _0x45773b=_0x3173dc[0x0],_0x5b30b=_0x5e54a5+_0x45773b,_0x1be014=_0x3dc0a2[_0x5b30b];if(!_0x1be014){if(a20_0x10a1['CYSNzr']===undefined){const _0x52bb2e=function(_0x2cf516){this['amolVD']=_0x2cf516,this['pXDCiI']=[0x1,0x0,0x0],this['QjoRLW']=function(){return'newState';},this['Zypyrf']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['vPGehJ']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x52bb2e['prototype']['aBiKIX']=function(){const _0x1e9e71=new RegExp(this['Zypyrf']+this['vPGehJ']),_0x47570b=_0x1e9e71['test'](this['QjoRLW']['toString']())?--this['pXDCiI'][0x1]:--this['pXDCiI'][0x0];return this['iuRyrE'](_0x47570b);},_0x52bb2e['prototype']['iuRyrE']=function(_0x10338){if(!Boolean(~_0x10338))return _0x10338;return this['UblRSG'](this['amolVD']);},_0x52bb2e['prototype']['UblRSG']=function(_0x5d4a9d){for(let _0x4e12e7=0x0,_0x592365=this['pXDCiI']['length'];_0x4e12e7<_0x592365;_0x4e12e7++){this['pXDCiI']['push'](Math['round'](Math['random']())),_0x592365=this['pXDCiI']['length'];}return _0x5d4a9d(this['pXDCiI'][0x0]);},new _0x52bb2e(a20_0x10a1)['aBiKIX'](),a20_0x10a1['CYSNzr']=!![];}_0x2bb9f8=a20_0x10a1['AdRXtY'](_0x2bb9f8,_0x462c02),_0x3dc0a2[_0x5b30b]=_0x2bb9f8;}else _0x2bb9f8=_0x1be014;return _0x2bb9f8;},a20_0x10a1(_0x3dc0a2,_0x1bd49d);}function a20_0x2bb9(){const _0x82b61d=['amoQtCkl','WOxdGemGWRu','W7CuW5RcSmoHdCo1','imopWRtdPSkeyY/dTce','WRhdO8ossmoIW4VdTmkrWRxdUviuqa','W4NcNmk1ja','B1xdQrGcWPyHi8oHya','cSk2z1Gy','WOuIAmkksxrbkfRdOq','pNxdGsboWQ1P','WPxcQmoRsG','WQVcMvS','umopBCkH','WRVcVYBdSq','W7WYp8oFybu','WRFcQZZdTSo0','WRlcKSowEG','d1RdTZnPEdlcIwVdU1Wk','W5/dJSosEG','CSkOW5BcTmoY','geFcT8oOW7q','AH42WOFdICkGn2O1W6JdVry','iWGSwCo9W49szGRcTq','WPmsW6q7t8kCtq','g1BcTmoHWQddR2u','cLlcQCoG','ACkOW4GNW5pdVqhcVa','amoNW6BdGbdcPa','W77cOSoGsSoaxSojW6m','W5hdOb9V','W5hdJ8ouySkY','WQj3rCoGW5SVWRxcKa','EWbnlqPCW43cOItcIW','W6PqmMzlW6BdMSoo','re7dOulcPSoiW5FcHCkOrCoAgCo2','hailWRfe','WORcPuq5DMiqySk1WOldJGVcNmki','hce1WP1K','tbddLHDBae8PW5FcGCke','DsJcHxGxW7LfbCoxEmoVWQS','ACohWQJdQSklzsZdSY4A','xH3dGKVdUmkGWPlcKmkCW7W1','t8kcta','x8osDa','W4BdMmoCzSk0xa','xKZcGsGikCkPWQBcU8ovy3lcSCoQ','W6nzhgeIWQCoW6RcI17dShC','rSozWQBdOa','eSkJamkjxq','nCoNeY5cWRFdSCkdWOix','nrRdQ8oh','W440fCkm','EevWeSkU','pSofb8k5b8okh0xdPJe','wmkKE8od','nSo2gIG','W41Lk8obfa','y8kosCoLsSkn','WPldL0SKWRnX','aa/dM3q','nCoVfIC','u8oDWQhdQa','WPJdNCki','p2zOWPtcR1X6WPtcQv4','WRhcSJJdUSoUvM4','zdJcMwieW6CNxmkpgW','W781mmovjb7cPCkOmf0','h8o2W6NdKXhcVW','nCoVWRn9WORcVutdSSkYEq','hdDrfve','W4z1iSolaW','q1nIW6VcGMq','WQG2WRKeA8kUFCkWxGm','imoRgcyhWRFdQSke','mMlcSwS4gMixW7FcIq','BfRcSCkrWQapWP7dKtO4WQS','WRv2vSo1W5O1','kWBdL8oDW6q0WRZdNG','WQjoWOhdRmkymCoCm8o/shy','zrjKW6tcQCo4dv0','vb7cMHxcQCkPWPBcKq','WRjTzmo1W50VWRtcMq','WRf7WR5h','W4pcOmk2WOm','fL9sWQ8','meLSW4dcHCoLc3KYW40','W601m8oE','WQ8qnuvMW7O','W6NcPSojbSk/WPVcP8k1','W4JcPmkSWPZcS2BdKq','W6xcTSodWO4x','W4OzW5in','WQDVWQrd','FmkMzmo6AW','W6FdVIpdS8o7y3v5','ANuIsHa0W5tcUbBcTK/cKxy','CmkcW7BcUCo+W7S','mmoHetGwWQVdQ8kuW5yE'];a20_0x2bb9=function(){return _0x82b61d;};return a20_0x2bb9();}a20_0x5e54a5();const fileSchema=require(a20_0x371ab5(0x18d,'ckgF')+'ls/file'),videoSchema=require('../../mode'+a20_0x371ab5(0x1b0,'c088')),base64=require(a20_0x371ab5(0x1d2,'LB3T')),redisClient=require(a20_0x371ab5(0x1c2,'6NWC')+'s'),encodeUrl=_0x4ebd53=>{const _0x47334a=a20_0x371ab5,_0x3bfa9f=base64['encode'](_0x4ebd53);var _0x51f139='';for(var _0x56a90f=_0x3bfa9f[_0x47334a(0x1d5,'[A5Z')]-0x1;_0x56a90f>=0x0;_0x56a90f--){_0x51f139+=_0x3bfa9f[_0x56a90f];}return _0x51f139[_0x47334a(0x1c3,'Y99n')](/=/g,'');};module[a20_0x371ab5(0x198,'fZIZ')]=(_0x7e6e35,_0x56566d)=>{const _0x2e5359=a20_0x371ab5;return new Promise((_0x18fa9a,_0x2115af)=>{const _0x1d1ec4=a20_0x10a1;if(_0x1d1ec4(0x17b,'@ECQ')===_0x1d1ec4(0x19e,'6NWC'))return _0x55bebf[_0x1d1ec4(0x1a4,'*675')](0x194),_0x16132f['json']({'message':_0x1d1ec4(0x194,'R#rJ'),'message':_0x1d1ec4(0x19a,')Vzm')+_0x1d1ec4(0x1c7,'fZIZ')}),_0x4f22ce();else redisClient['get'](_0x7e6e35['params']['id'],async(_0x325feb,_0x46c38f)=>{const _0x4e5cf2=_0x1d1ec4;if(_0x4e5cf2(0x1b5,'ckgF')!==_0x4e5cf2(0x188,'gzUg')){_0x325feb&&(_0x4e5cf2(0x19d,'#jAr')!=='FRYMK'?_0x2115af(_0x325feb):_0x49629b+=_0x407118[_0x287e0e]);if(_0x46c38f)return _0x4e5cf2(0x1c1,'ccNp')!=='tCeMM'?(_0x56566d[_0x4e5cf2(0x1d3,'LB3T')](_0x46c38f),_0x18fa9a()):(_0x526379[_0x4e5cf2(0x1af,'JdKA')](0x194),_0x1a7d4b[_0x4e5cf2(0x1cc,'$Soq')]({'message':_0x4e5cf2(0x1ab,'ndG['),'message':_0x4e5cf2(0x180,'f]n]')+'ound'}),_0x13cf82());const _0x18f5c4=await videoSchema[_0x4e5cf2(0x1bc,'tR$P')]({'_id':_0x7e6e35['params']['id'],'files':{'$exists':!![],'$not':{'$size':0x0}}})[_0x4e5cf2(0x18f,'R#rJ')]();if(!_0x18f5c4)return'cmBLj'==='UQCnK'?new _0x50b1b9((_0xbac36,_0x5b0f49)=>{const _0x16634f=_0x4e5cf2;_0x5ae5a2=_0x199ad3(_0x89d2d[_0x16634f(0x1d8,'$Soq')]),_0xbac36(_0x3c5ac3['env'][_0x16634f(0x18e,'ckgF')]+'/api/hls/'+_0x394e97);}):(_0x56566d[_0x4e5cf2(0x19b,'[A5Z')](0x194),_0x56566d[_0x4e5cf2(0x18a,'Djct')]({'message':_0x4e5cf2(0x1b4,'GdZ0'),'message':_0x4e5cf2(0x189,'R#rJ')+_0x4e5cf2(0x1ca,'!FFq')}),_0x18fa9a());const _0x522cba=await fileSchema['findOne']({'_id':_0x18f5c4[_0x4e5cf2(0x190,'6NWC')][0x0][_0x4e5cf2(0x182,'ckgF')]})['exec']();if(!_0x522cba)return _0x4e5cf2(0x1b2,'GRXL')!==_0x4e5cf2(0x17d,'@ECQ')?(_0x1334a9&&_0x19b288(_0x1514dc),_0x5e7777[_0x4e5cf2(0x195,'Ds8s')](_0x46565c),_0x3dfc5b()):(_0x56566d['status'](0x194),_0x56566d[_0x4e5cf2(0x1c6,'NtTJ')]({'message':_0x4e5cf2(0x18b,'iQW9'),'message':'file\x20not\x20f'+_0x4e5cf2(0x193,'N6#!')}),_0x18fa9a());var _0x5eca22=['#EXTM3U',_0x4e5cf2(0x1c0,'Y99n')+'SION:'+_0x522cba['version'],'#EXT-X-PLA'+_0x4e5cf2(0x197,'A6T3')+_0x4e5cf2(0x1ba,'NtTJ'),_0x4e5cf2(0x178,'#jAr')+_0x4e5cf2(0x1a2,'pdQm')+'N:'+_0x522cba['targetDura'+_0x4e5cf2(0x1ae,')Vzm')],'#EXT-X-MED'+_0x4e5cf2(0x1a0,'P2u1')+_0x4e5cf2(0x196,'!FFq')];const _0xb50893=_0x522cba['segments']['map']((_0x36d078,_0x428946)=>{return new Promise((_0x4d50f8,_0x51493f)=>{const _0x33758e=a20_0x10a1;encoded_url=encodeUrl(_0x36d078[_0x33758e(0x1bb,'m9hU')]),_0x4d50f8(process[_0x33758e(0x183,'NtTJ')][_0x33758e(0x1c4,'!FFq')]+_0x33758e(0x1bd,'f]n]')+encoded_url);});});await Promise[_0x4e5cf2(0x1c5,'nWV3')](_0xb50893)['then'](_0x3dd6ee=>{const _0xee138f=_0x4e5cf2;index=0x0;for(const _0x12b5b1 of _0x3dd6ee){_0x5eca22['push'](_0xee138f(0x1d6,'!FFq')+_0x522cba[_0xee138f(0x1a1,'R#rJ')][index][_0xee138f(0x1d9,'*675')]+','),_0x5eca22[_0xee138f(0x1ac,'A6T3')](_0x12b5b1),index+=0x1;}_0x5eca22[_0xee138f(0x1aa,'GdZ0')]('#EXT-X-END'+_0xee138f(0x1bf,'c088'));})['then'](()=>{const _0x10ba4d=_0x4e5cf2,_0x295fe6=_0x5eca22[_0x10ba4d(0x1b3,')Wny')]('\x0a');redisClient[_0x10ba4d(0x18c,'BeDz')](_0x7e6e35[_0x10ba4d(0x1b8,'Wj!V')]['id'],0x14*0xe10,_0x295fe6,_0x3d9608=>{return _0x3d9608&&_0x2115af(_0x3d9608),_0x56566d['send'](_0x295fe6),_0x18fa9a();});});}else{const _0xbca031=_0x2a6faf[_0x4e5cf2(0x1c8,')Vzm')](_0x26f491);var _0x18a7bb='';for(var _0x140492=_0xbca031[_0x4e5cf2(0x19f,'aq2S')]-0x1;_0x140492>=0x0;_0x140492--){_0x18a7bb+=_0xbca031[_0x140492];}return _0x18a7bb[_0x4e5cf2(0x1d1,'P2u1')](/=/g,'');}});})[_0x2e5359(0x1c9,'fZIZ')](_0x53d2f9=>{const _0x642616=_0x2e5359;if('rKRla'===_0x642616(0x1cd,'Wj!V')){_0x56566d[_0x642616(0x1d7,'*sU5')]({'status':_0x642616(0x187,'Ds8s'),'message':_0x53d2f9[_0x642616(0x1b1,'ndG[')]});return;}else return _0x5407e0[_0x642616(0x1d4,'[oaB')]()[_0x642616(0x192,'m9hU')]('(((.+)+)+)'+'+$')[_0x642616(0x1a9,'*675')]()[_0x642616(0x1ad,'EDKt')+'r'](_0x2012a8)['search'](_0x642616(0x19c,'[oaB')+'+$');});};